---
layout: html.njk
pagination:
  data: beancounter.users
  size: 1
  alias: member
  resolve: values
permalink: 'share/{{ member.username | hash }}/index.html'

sectionHeight: 50vh
downstairsCost: 2.1
costaCost: 3.2
---

{% set totalCups = member.cups | sumRecords %}
{% set totalBeans = (member.beans | sumRecords) / 1000 %}
{% set totalBags = member.beans.length %}
{% set costPerCup = totalBeans * config.pricePerKilogram / totalCups %}

<main>
  <center-layout>
    <stack-layout space="s4">
      <header class="pageHeader">
        <h1>{{ site.title }}</h1>
        <p>It's <em>bean</em> a year to remember!</p>
      </header>

      <cover-layout centered="center-layout" space="0" minHeight="{{ sectionHeight }}">
        <center-layout intrinsic>
          <usage-planet
            image="{{ headshots[member.username] }}"
            endpoint="./usage.json"
          ></usage-planet>
        </center-layout>
      </cover-layout>
      
      <cover-layout centered="section" space="0" minHeight="{{ sectionHeight }}">
        <section class="textStats flow">
          {% if totalCups === 0 %}
          <p>You didn't drink any coffee this year.</p>
          {% else %}
          <p>
            You had <span class="coolStat">{{ totalCups | formatCups }}</span> of coffee,
            that's about <fun-metric type="volume" value="{{ totalCups * config.cupVolume }}"></fun-metric>.
          </p>
          {% endif %}
          
          {% if totalBeans == 0 %}
          <p>You didn't buy any coffee this year.</p>
          {% else %}
          <p>
            You bought <span class="coolStat">{{ totalBeans | formatBeans }}</span> of beans.
            That's about <fun-metric type="weight" value="{{ totalBeans }}"></fun-metric>
            or <fun-metric type="length" value="{{ totalBeans * config.beansPerKilogram * config.beanLength }}"></fun-metric> if you lined up all the beans.
          </p>
          <p>
            On average each cup of coffee cost you 
            <span class="coolStat">{{ costPerCup | formatCost }}</span>.

            That's <span class="coolStat">{{ (downstairsCost / costPerCup).toFixed(0) }}⨉</span> cheaper than downstairs. Those same coffees would have cost you <span class="coolStat">£{{ (totalCups * costaCost).toFixed(2) }}</span> at Costa!
          </p>
          {% endif %}
        </section>
      </cover-layout>
      
      <cover-layout centered="section" space="0" minHeight="{{ sectionHeight }}">
        <section class="flow">
          <h2>Coffees habbits</h2>
          <switcher-layout limit="5">
            <div class="dayCard">
              <header>MON</header>
              <span class="coolStat">
                {{ member.cups | dailyAverage(1) | formatCups }}
              </span>
            </div>
            <div class="dayCard">
              <header>TUE</header>
              <span class="coolStat">
                {{ member.cups | dailyAverage(2) | formatCups }}
              </span>
            </div>
            <div class="dayCard">
              <header>WED</header>
              <span class="coolStat">
                {{ member.cups | dailyAverage(3) | formatCups }}
              </span>
            </div>
            <div class="dayCard">
              <header>THU</header>
              <span class="coolStat">
                {{ member.cups | dailyAverage(4) | formatCups }}
              </span>
            </div>
            <div class="dayCard">
              <header>FRI</header>
              <span class="coolStat">
                {{ member.cups | dailyAverage(5) | formatCups }}
              </span>
            </div>
          </switcher-layout>
          <hourly-graph endpoint="./hourly-cups.json"></hourly-graph>
        </section>
      </cover-layout>
      
      {% if totalCups > 0 %}
      <cover-layout centered="section" space="0" minHeight="{{ sectionHeight }}">
        <section class="flow">
          <h2>Your coffees this year</h2>
          <cups-graph endpoint="./monthly-cups.json"></cups-graph>
        </section>
      </cover-layout>
      {% endif %}
      
      {% if totalBeans > 0 %}
      <cover-layout centered="section" space="0" minHeight="{{ sectionHeight }}">
        <section class="flow">
          <h2>Your purchases</h2>
          <beans-graph endpoint="./monthly-beans.json"></beans-graph>
        </section>
      </cover-layout>
      {% endif %}

      <pre id="data" aria-hidden="true"></pre>
    </stack-layout>
  </center-layout>
</main>

{% include 'footer.njk' %}

<script type="module" src="/js/member.js"></script>
